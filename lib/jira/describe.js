var e=this&&this.__createBinding||(Object.create?function(e,s,t,i){void 0===i&&(i=t),Object.defineProperty(e,i,{enumerable:!0,get:function(){return s[t]}})}:function(e,s,t,i){void 0===i&&(i=t),e[i]=s[t]}),s=this&&this.__setModuleDefault||(Object.create?function(e,s){Object.defineProperty(e,"default",{enumerable:!0,value:s})}:function(e,s){e.default=s}),t=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var i={};if(null!=t)for(var o in t)"default"!==o&&Object.prototype.hasOwnProperty.call(t,o)&&e(i,t,o);return s(i,t),i},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.addDescribeCommand=void 0;const o=i(require("../ssl_request")),l=i(require("cli-table")),r=i(require("openurl")),n=i(require("url")),d=i(require("../config")),a=require("../entrypoint"),u=require("../helpers/helpers"),f=t(require("os"));exports.addDescribeCommand=e=>{e.command("show <issue>").description("Show info about an issue").option("-o, --output <field>","Output field content",String).action((async(e,s)=>{try{const s=await u.client.issues.getIssue({issueIdOrKey:e,fields:["*all"]});c(s)}catch(e){console.error(e)}})).command("_complete").action(a.issuePickerCompletionAsync)};const c=e=>{const s=new l.default;e.fields.comment.comments.map((e=>String(e.body.toString()+"--"+e.author.displayName))).join(f.EOL);s.push({Issue:e.key},{Summary:e.fields.summary},{Type:e.fields.issuetype.name},{Priority:e.fields.priority.name},{Status:e.fields.status.name},{Reporter:e.fields.reporter.displayName+" <"+e.fields.reporter.emailAddress+"> "},{Assignee:(e.fields.assignee?e.fields.assignee.displayName:"Not Assigned")+" <"+(e.fields.assignee?e.fields.assignee.emailAddress:"")+"> "},{Labels:e.fields.labels?e.fields.labels.join(", "):""},{Subtasks:e.fields.subtasks.length}),console.log(s.toString()),console.log(e.fields.description);const t=process.stdout.getWindowSize(),i=new Array(t[0]-20).fill("-",0).join("");console.log(i),console.log("<----------------------------\x3e"),console.log(e.fields.comment.comments.map((e=>String("---------------------"+f.EOL+e.updated.toString()+f.EOL+e.body.toString()+f.EOL+"  "+e.author.displayName))).join(f.EOL))};exports.default={query:null,priority:null,table:null,getIssueField:function(e){o.default.get(d.default.auth.url+this.query+"?fields="+e??"*all").end(((s,t)=>{if(!t.ok)return console.log(t);t.body.fields?"string"==typeof t.body.fields[e]?console.log(t.body.fields[e]):console.log(t.body.fields[e].name):console.log("Field does not exist.")}))},getIssue:function(){o.default.get(d.default.auth.url+this.query).end(((e,s)=>{if(!s.ok)return console.log(s);this.table=new l.default,this.priority=s.body.fields.priority,this.description=s.body.fields.description,this.priority||(this.priority={name:""}),this.description||(this.description="No details"),this.table.push({Issue:s.body.key},{Summary:s.body.fields.summary},{Type:s.body.fields.issuetype.name},{Priority:this.priority.name},{Status:s.body.fields.status.name},{Reporter:s.body.fields.reporter.displayName+" <"+s.body.fields.reporter.emailAddress+"> "},{Assignee:(s.body.fields.assignee?s.body.fields.assignee.displayName:"Not Assigned")+" <"+(s.body.fields.assignee?s.body.fields.assignee.emailAddress:"")+"> "},{Labels:s.body.fields.labels?s.body.fields.labels.join(", "):""},{Subtasks:s.body.fields.subtasks.length},{Comments:s.body.fields.comment.total}),console.log(this.table.toString()),console.log("\r\n"+this.description+"\r\n")}))},open:function(e){r.default.open(n.default.resolve(d.default.auth.url,"browse/"+e))},show:function(e,s){return this.query="rest/api/latest/issue/"+e,s?this.getIssueField(s):this.getIssue()}};