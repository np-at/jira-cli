var e=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0});const t=e(require("../ssl_request")),n=e(require("cli-table")),o=e(require("../config"));exports.default=(()=>{const e=(e,t,o)=>{const s=new n.default({head:["Key","Name"]});let r=[];for(let n=0;n<t.views.length;n++){const o=t.views[n];if(void 0!==e){if(o.name.toLowerCase()===e.toLowerCase()){r=[[o.id,o.name]];break}if(-1===o.name.toLowerCase().indexOf(e.toLowerCase()))continue}r.push([o.id,o.name])}s.push(...s,...r),0===s.length?void 0===e?console.log("No rapid boards found in your Jira instance"):console.log("No rapid boards found matching term in your Jira instance: "+e):1===s.length?(console.log("****Found Rapid Board: "+s[0][1]),o(s[0][0])):(console.log("\nMatching Rapid Boards:"),console.log("=========================================\n"),console.log(s.toString()))},s=(e,t,o,s)=>{const r=new n.default({head:["Key","Name","Status"]});let i=[];for(let e=0;e<o.sprints.length;e++){const n=o.sprints[e];if(void 0!==t){if(n.name.toLowerCase()===t.toLowerCase()){i=[[n.id,n.name,n.state]];break}if("ACTIVE"!==n.state)continue;if(-1===n.name.toLowerCase().indexOf(t.toLowerCase()))continue}i.push([n.id,n.name,n.state])}if(r.push(...r,...i),0===r.length)void 0===t?console.log("No sprints found in rapid board "+e):console.log("No sprints found matching term in rapid board "+e+": "+t);else{if(1!==r.length)return console.log("\nMatching Sprints:"),console.log("=========================================\n"),console.log(r.toString()),s(i[i.length-1][0],i);console.log("****Found Sprint: "+r[0][1]),s(r[0][0])}},r=function(e,t,o){const s=new n.default({head:["Key","Name","Status","Start Date","End Date"]}),r=new n.default({head:["Key","Type","Assignee","Priority","Status","Summary"]}),i=new n.default({head:["Key","Type","Assignee","Priority","Status","Summary"]}),a=new n.default({head:["Key","Type","Assignee","Priority","Status","Summary"]}),l=function(e,t){e&&e.forEach((function(e){const n=e.priorityName||"Unknown",o=e.summary.length>45?e.summary.substr(0,42)+"...":e.summary,s=e.statusName||"Unknown",r=e.assignee||"None",i=e.key||"Unknown",a=e.typeName||"Unknown";t.push([i,a,r,n,s,o])}))};l(o.contents.completedIssues,r),l(o.contents.issuesNotCompletedInCurrentSprint,i),l(o.contents.puntedIssues,a),s.push([o.sprint.id,o.sprint.name,o.sprint.state,o.sprint.startDate,o.sprint.endDate]);const u=function(e,t){t.length>0&&(console.log(e),console.log(t.toString()),console.log("\n==============================================================\n"))};console.log("\n=============================================================="),console.log("====                        SPRINT                        ===="),console.log("==============================================================\n"),u("Sprint:",s),u("Completed Issues:",r),u("Punted Issues:",a),u("Incompleted Issues:",i)};return function(n,i,a){((n,s)=>{"string"!=typeof n&&(n=void 0),t.default.get(o.default.auth.url+"rest/greenhopper/latest/rapidviews/list").end(((t,o)=>{o.ok?e(n,o.body,s):console.log("Error getting rapid boards. HTTP Status Code: "+o.status)}))})(n,(function(e){!function(e,n,r){"string"!=typeof n&&(n=void 0),t.default.get(o.default.auth.url+"rest/greenhopper/latest/sprintquery/"+e).end(((t,o)=>{o.ok?s(e,n,o.body,r):console.log("Error getting sprints. HTTP Status Code: "+o.status)}))}(e,i,(function(n,s){!function(e,n,s){let r="rapidViewId="+e;n&&(r+="&sprintId="+n),t.default.get(o.default.auth.url+"rest/greenhopper/latest/rapid/charts/sprintreport?"+r).end(((e,t)=>{if(!t.ok)return console.log("Error getting sprint data. HTTP Status Code: "+t.status),void console.dir(t.body);s(t.body)}))}(e,n,(function(e){if(a)return r(0,0,e),a(s);r(0,0,e)}))}))}))}})();